<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Timefordeling</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="color-scheme" content="light dark">
    <link th:href="@{/css/pico.pink.min.css}" rel="stylesheet">
    <link th:href="@{/css/main.css}" rel="stylesheet">
</head>
<body>
<div th:replace="~{fragments/header :: header}">...</div>

<main class="container-fluid">
    <th:block th:replace="~{fragments/project_nav :: projectNav(${project})}"></th:block>

    <div>
        <!-- The canvas element where Chart.js will draw the bar chart -->
        <canvas id="hoursChart" width="800" height="400"></canvas>
    </div>

    <!-- Load the Chart.js library from a CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Tell Thymeleaf to allow JavaScript expressions inside this script tag -->
    <script th:inline="javascript">

        // Get a reference to the <canvas> element. This will be passed to the Chart.js constructor.
        const ctx = document.getElementById('hoursChart')

        // Thymeleaf replaces hourDistributionMap.keySet() with a JS array of dates.
        const labels = [[${hourDistributionMap.keySet()}]]; // dates

        // Thymeleaf replaces hourDistributionMap.values() with a JS array of numbers.
        const data = [[${hourDistributionMap.values()}]];   // hours

        // Create a new bar chart using Chart.js. The chart will be drawn on the canvas element referenced by ctx.
        new Chart(ctx, {
            // Choose the chart type: "bar" makes a bar graph
            type: 'bar',

            // Data section: what points will the chart plot?
            data: {
                labels: labels, // X-axis labels (dates)
                datasets: [{
                    label: 'Estimerede timer pr. arbejdsdag', // Name shown in the chart header
                    data: data, // Y-axis values (hours)
                    borderWidth: 1 // width of bar borders
                }]
            },

            // Optional settings to control how the chart behaves
            options: {
                scales: {
                    y: { beginAtZero: true } // ensures y-axis starts at 0 for clarity
                }
            }
        });
    </script>
</main>

<div th:replace="~{fragments/footer :: footer}">...</div>
</body>
</html>